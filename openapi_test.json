{"openapi":"3.1.0","info":{"title":"AdaptiveAuth Framework Live Test Application","description":"Interactive demonstration of all AdaptiveAuth features","version":"1.0.0"},"paths":{"/auth/register":{"post":{"tags":["Authentication"],"summary":"Register","description":"Register a new user.","operationId":"register_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRegister"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/login":{"post":{"tags":["Authentication"],"summary":"Login","description":"Standard OAuth2 login endpoint.\nFor risk-based login, use /auth/adaptive-login.","operationId":"login_auth_login_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_auth_login_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/adaptive-login":{"post":{"tags":["Authentication"],"summary":"Adaptive Login","description":"Risk-based adaptive login.\nReturns detailed risk assessment and may require step-up authentication.","operationId":"adaptive_login_auth_adaptive_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdaptiveLoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdaptiveLoginResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/step-up":{"post":{"tags":["Authentication"],"summary":"Step Up Verification","description":"Complete step-up authentication challenge.","operationId":"step_up_verification_auth_step_up_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StepUpRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StepUpResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/login-otp":{"post":{"tags":["Authentication"],"summary":"Login With Otp","description":"Login using TOTP code only (for 2FA-enabled users).","operationId":"login_with_otp_auth_login_otp_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginOTP"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/logout":{"post":{"tags":["Authentication"],"summary":"Logout","description":"Logout current user.","operationId":"logout_auth_logout_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/forgot-password":{"post":{"tags":["Authentication"],"summary":"Forgot Password","description":"Request password reset email.","operationId":"forgot_password_auth_forgot_password_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordResetRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/reset-password":{"post":{"tags":["Authentication"],"summary":"Reset Password","description":"Reset password with token.","operationId":"reset_password_auth_reset_password_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordResetConfirm"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/enable-2fa":{"post":{"tags":["Authentication"],"summary":"Enable 2Fa","description":"Enable 2FA for current user.","operationId":"enable_2fa_auth_enable_2fa_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Enable2FAResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/verify-2fa":{"post":{"tags":["Authentication"],"summary":"Verify 2Fa","description":"Verify and activate 2FA.","operationId":"verify_2fa_auth_verify_2fa_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Verify2FARequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/auth/disable-2fa":{"post":{"tags":["Authentication"],"summary":"Disable 2Fa","description":"Disable 2FA for current user.","operationId":"disable_2fa_auth_disable_2fa_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"password","in":"query","required":true,"schema":{"type":"string","title":"Password"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/user/profile":{"get":{"tags":["User"],"summary":"Get Profile","description":"Get current user's profile.","operationId":"get_profile_user_profile_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"put":{"tags":["User"],"summary":"Update Profile","description":"Update current user's profile.","operationId":"update_profile_user_profile_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/user/security":{"get":{"tags":["User"],"summary":"Get Security Settings","description":"Get user's security settings.","operationId":"get_security_settings_user_security_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserSecuritySettings"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/user/change-password":{"post":{"tags":["User"],"summary":"Change Password","description":"Change user's password.","operationId":"change_password_user_change_password_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordChange"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/user/devices":{"get":{"tags":["User"],"summary":"Get Devices","description":"Get user's known devices.","operationId":"get_devices_user_devices_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeviceListResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/user/devices/{device_id}":{"delete":{"tags":["User"],"summary":"Remove Device","description":"Remove a known device.","operationId":"remove_device_user_devices__device_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"device_id","in":"path","required":true,"schema":{"type":"string","title":"Device Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/user/sessions":{"get":{"tags":["User"],"summary":"Get Sessions","description":"Get user's active sessions.","operationId":"get_sessions_user_sessions_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionListResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/user/sessions/revoke":{"post":{"tags":["User"],"summary":"Revoke Sessions","description":"Revoke user sessions.","operationId":"revoke_sessions_user_sessions_revoke_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionRevokeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/user/risk-profile":{"get":{"tags":["User"],"summary":"Get Risk Profile","description":"Get user's risk profile summary.","operationId":"get_risk_profile_user_risk_profile_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/admin/users":{"get":{"tags":["Admin"],"summary":"List Users","description":"List all users (admin only).","operationId":"list_users_admin_users_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Page Size"}},{"name":"role","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Role"}},{"name":"is_active","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminUserList"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/users/{user_id}":{"get":{"tags":["Admin"],"summary":"Get User","description":"Get user details (admin only).","operationId":"get_user_admin_users__user_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/users/{user_id}/block":{"post":{"tags":["Admin"],"summary":"Block User","description":"Block a user (admin only).","operationId":"block_user_admin_users__user_id__block_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}},{"name":"reason","in":"query","required":false,"schema":{"type":"string","default":"Administrative action","title":"Reason"}},{"name":"duration_hours","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Duration Hours"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/users/{user_id}/unblock":{"post":{"tags":["Admin"],"summary":"Unblock User","description":"Unblock a user (admin only).","operationId":"unblock_user_admin_users__user_id__unblock_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/sessions":{"get":{"tags":["Admin"],"summary":"List Sessions","description":"List all active sessions (admin only).","operationId":"list_sessions_admin_sessions_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"status_filter","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status Filter"}},{"name":"risk_level","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Risk Level"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Page Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/sessions/{session_id}/revoke":{"post":{"tags":["Admin"],"summary":"Revoke Session","description":"Revoke a specific session (admin only).","operationId":"revoke_session_admin_sessions__session_id__revoke_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"integer","title":"Session Id"}},{"name":"reason","in":"query","required":false,"schema":{"type":"string","default":"Administrative action","title":"Reason"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/risk-events":{"get":{"tags":["Admin"],"summary":"List Risk Events","description":"List risk events (admin only).","operationId":"list_risk_events_admin_risk_events_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"risk_level","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Risk Level"}},{"name":"event_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Event Type"}},{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"User Id"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Page Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RiskEventList"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/anomalies":{"get":{"tags":["Admin"],"summary":"List Anomalies","description":"List detected anomaly patterns (admin only).","operationId":"list_anomalies_admin_anomalies_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"active_only","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"Active Only"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnomalyListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/anomalies/{anomaly_id}/resolve":{"post":{"tags":["Admin"],"summary":"Resolve Anomaly","description":"Resolve an anomaly pattern (admin only).","operationId":"resolve_anomaly_admin_anomalies__anomaly_id__resolve_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"anomaly_id","in":"path","required":true,"schema":{"type":"integer","title":"Anomaly Id"}},{"name":"false_positive","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"False Positive"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/statistics":{"get":{"tags":["Admin"],"summary":"Get Statistics","description":"Get admin dashboard statistics.","operationId":"get_statistics_admin_statistics_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminStatistics"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/admin/risk-statistics":{"get":{"tags":["Admin"],"summary":"Get Risk Statistics","description":"Get risk statistics for a period.","operationId":"get_risk_statistics_admin_risk_statistics_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"period","in":"query","required":false,"schema":{"type":"string","pattern":"^(day|week|month)$","default":"day","title":"Period"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RiskStatistics"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/risk/overview":{"get":{"tags":["Risk Dashboard"],"summary":"Get Risk Overview","description":"Get risk dashboard overview.","operationId":"get_risk_overview_risk_overview_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RiskDashboardOverview"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/risk/assess":{"post":{"tags":["Risk Dashboard"],"summary":"Assess Risk","description":"Manually assess risk for a context or user.","operationId":"assess_risk_risk_assess_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/risk/profile/{user_id}":{"get":{"tags":["Risk Dashboard"],"summary":"Get User Risk Profile","description":"Get detailed risk profile for a user.","operationId":"get_user_risk_profile_risk_profile__user_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/risk/active-sessions":{"get":{"tags":["Risk Dashboard"],"summary":"Get High Risk Sessions","description":"Get sessions with elevated risk levels.","operationId":"get_high_risk_sessions_risk_active_sessions_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"min_risk_level","in":"query","required":false,"schema":{"type":"string","pattern":"^(low|medium|high|critical)$","default":"medium","title":"Min Risk Level"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/risk/login-patterns":{"get":{"tags":["Risk Dashboard"],"summary":"Get Login Patterns","description":"Get login patterns analysis.","operationId":"get_login_patterns_risk_login_patterns_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"hours","in":"query","required":false,"schema":{"type":"integer","maximum":168,"minimum":1,"default":24,"title":"Hours"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/risk/suspicious-ips":{"get":{"tags":["Risk Dashboard"],"summary":"Get Suspicious Ips","description":"Get IPs with suspicious activity.","operationId":"get_suspicious_ips_risk_suspicious_ips_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/risk/block-ip":{"post":{"tags":["Risk Dashboard"],"summary":"Block Ip","description":"Block an IP address (creates anomaly pattern).","operationId":"block_ip_risk_block_ip_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"ip_address","in":"query","required":true,"schema":{"type":"string","title":"Ip Address"}},{"name":"reason","in":"query","required":false,"schema":{"type":"string","default":"Suspicious activity","title":"Reason"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/adaptive/assess":{"post":{"tags":["Adaptive Authentication"],"summary":"Assess Current Risk","description":"Assess current risk level for authenticated user.","operationId":"assess_current_risk_adaptive_assess_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RiskAssessmentResult"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/adaptive/verify-session":{"post":{"tags":["Adaptive Authentication"],"summary":"Verify Session","description":"Verify current session is still valid and not compromised.\nUse this periodically during sensitive operations.","operationId":"verify_session_adaptive_verify_session_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/adaptive/challenge":{"post":{"tags":["Adaptive Authentication"],"summary":"Request Challenge","description":"Request a new authentication challenge for step-up auth.","operationId":"request_challenge_adaptive_challenge_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChallengeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChallengeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/adaptive/verify":{"post":{"tags":["Adaptive Authentication"],"summary":"Verify Challenge","description":"Verify a step-up authentication challenge.","operationId":"verify_challenge_adaptive_verify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyChallengeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/adaptive/security-status":{"get":{"tags":["Adaptive Authentication"],"summary":"Get Security Status","description":"Get current security status for the user.","operationId":"get_security_status_adaptive_security_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/adaptive/trust-device":{"post":{"tags":["Adaptive Authentication"],"summary":"Trust Current Device","description":"Mark current device as trusted.","operationId":"trust_current_device_adaptive_trust_device_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/adaptive/trust-device/{device_index}":{"delete":{"tags":["Adaptive Authentication"],"summary":"Remove Trusted Device","description":"Remove a device from trusted devices.","operationId":"remove_trusted_device_adaptive_trust_device__device_index__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"device_index","in":"path","required":true,"schema":{"type":"integer","title":"Device Index"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/test-interface":{"get":{"summary":"Test Interface","description":"Serve the test interface","operationId":"test_interface_test_interface_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/protected":{"get":{"summary":"Protected Endpoint","description":"Protected endpoint that requires authentication","operationId":"protected_endpoint_protected_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/admin-only":{"get":{"summary":"Admin Only Endpoint","description":"Admin-only endpoint that requires admin role","operationId":"admin_only_endpoint_admin_only_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health Check","description":"Health check endpoint","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/demo/features":{"get":{"summary":"Demo Features","description":"Demonstrate all framework features","operationId":"demo_features_demo_features_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/test/register":{"post":{"summary":"Test Register","description":"Test endpoint for user registration","operationId":"test_register_test_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRegister"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/test/login":{"post":{"summary":"Test Login","description":"Test endpoint for user login","operationId":"test_login_test_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserLogin"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/test/create-user":{"post":{"summary":"Create Test User","description":"Create a test user programmatically","operationId":"create_test_user_test_create_user_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_create_test_user_test_create_user_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AdaptiveLoginRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"},"device_fingerprint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Device Fingerprint"},"remember_device":{"type":"boolean","title":"Remember Device","default":false}},"type":"object","required":["email","password"],"title":"AdaptiveLoginRequest","description":"Adaptive login request with context."},"AdaptiveLoginResponse":{"properties":{"status":{"type":"string","title":"Status"},"risk_level":{"type":"string","title":"Risk Level"},"security_level":{"type":"integer","title":"Security Level"},"access_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"},"token_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Token Type","default":"bearer"},"challenge_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Challenge Type"},"challenge_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Challenge Id"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"},"user_info":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"User Info"}},"type":"object","required":["status","risk_level","security_level"],"title":"AdaptiveLoginResponse","description":"Adaptive login response."},"AdminStatistics":{"properties":{"total_users":{"type":"integer","title":"Total Users"},"active_users":{"type":"integer","title":"Active Users"},"blocked_users":{"type":"integer","title":"Blocked Users"},"active_sessions":{"type":"integer","title":"Active Sessions"},"high_risk_events_today":{"type":"integer","title":"High Risk Events Today"},"failed_logins_today":{"type":"integer","title":"Failed Logins Today"},"new_users_today":{"type":"integer","title":"New Users Today"}},"type":"object","required":["total_users","active_users","blocked_users","active_sessions","high_risk_events_today","failed_logins_today","new_users_today"],"title":"AdminStatistics","description":"Admin dashboard statistics."},"AdminUserList":{"properties":{"users":{"items":{"$ref":"#/components/schemas/UserResponse"},"type":"array","title":"Users"},"total":{"type":"integer","title":"Total"},"page":{"type":"integer","title":"Page"},"page_size":{"type":"integer","title":"Page Size"}},"type":"object","required":["users","total","page","page_size"],"title":"AdminUserList","description":"Admin user list response."},"AnomalyListResponse":{"properties":{"anomalies":{"items":{"$ref":"#/components/schemas/AnomalyPatternResponse"},"type":"array","title":"Anomalies"},"total":{"type":"integer","title":"Total"}},"type":"object","required":["anomalies","total"],"title":"AnomalyListResponse","description":"List of anomaly patterns."},"AnomalyPatternResponse":{"properties":{"id":{"type":"integer","title":"Id"},"pattern_type":{"type":"string","title":"Pattern Type"},"severity":{"type":"string","title":"Severity"},"confidence":{"type":"number","title":"Confidence"},"is_active":{"type":"boolean","title":"Is Active"},"first_detected":{"type":"string","format":"date-time","title":"First Detected"},"last_detected":{"type":"string","format":"date-time","title":"Last Detected"},"pattern_data":{"additionalProperties":true,"type":"object","title":"Pattern Data"}},"type":"object","required":["id","pattern_type","severity","confidence","is_active","first_detected","last_detected","pattern_data"],"title":"AnomalyPatternResponse","description":"Detected anomaly pattern."},"Body_create_test_user_test_create_user_post":{"properties":{"email":{"type":"string","title":"Email"},"password":{"type":"string","title":"Password"},"full_name":{"type":"string","title":"Full Name"},"role":{"type":"string","title":"Role","default":"user"}},"type":"object","required":["email","password"],"title":"Body_create_test_user_test_create_user_post"},"Body_login_auth_login_post":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"^password$"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","format":"password","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"format":"password","title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_login_auth_login_post"},"ChallengeRequest":{"properties":{"challenge_type":{"type":"string","pattern":"^(otp|email|sms)$","title":"Challenge Type"},"session_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Session Id"}},"type":"object","required":["challenge_type"],"title":"ChallengeRequest","description":"Request a new challenge."},"ChallengeResponse":{"properties":{"challenge_id":{"type":"string","title":"Challenge Id"},"challenge_type":{"type":"string","title":"Challenge Type"},"expires_at":{"type":"string","format":"date-time","title":"Expires At"},"message":{"type":"string","title":"Message"}},"type":"object","required":["challenge_id","challenge_type","expires_at","message"],"title":"ChallengeResponse","description":"Challenge created response."},"DeviceInfo":{"properties":{"id":{"type":"string","title":"Id"},"name":{"type":"string","title":"Name"},"browser":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Browser"},"os":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Os"},"first_seen":{"type":"string","format":"date-time","title":"First Seen"},"last_seen":{"type":"string","format":"date-time","title":"Last Seen"},"is_current":{"type":"boolean","title":"Is Current","default":false}},"type":"object","required":["id","name","browser","os","first_seen","last_seen"],"title":"DeviceInfo","description":"Known device information."},"DeviceListResponse":{"properties":{"devices":{"items":{"$ref":"#/components/schemas/DeviceInfo"},"type":"array","title":"Devices"},"total":{"type":"integer","title":"Total"}},"type":"object","required":["devices","total"],"title":"DeviceListResponse","description":"List of known devices."},"Enable2FAResponse":{"properties":{"secret":{"type":"string","title":"Secret"},"qr_code":{"type":"string","title":"Qr Code"},"backup_codes":{"items":{"type":"string"},"type":"array","title":"Backup Codes"}},"type":"object","required":["secret","qr_code","backup_codes"],"title":"Enable2FAResponse","description":"Enable 2FA response with QR code."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LoginOTP":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"otp":{"type":"string","maxLength":6,"minLength":6,"title":"Otp"}},"type":"object","required":["email","otp"],"title":"LoginOTP","description":"Login with TOTP code."},"PasswordChange":{"properties":{"current_password":{"type":"string","title":"Current Password"},"new_password":{"type":"string","minLength":8,"title":"New Password"},"confirm_password":{"type":"string","title":"Confirm Password"}},"type":"object","required":["current_password","new_password","confirm_password"],"title":"PasswordChange","description":"Change password (authenticated)."},"PasswordResetConfirm":{"properties":{"reset_token":{"type":"string","title":"Reset Token"},"new_password":{"type":"string","minLength":8,"title":"New Password"},"confirm_password":{"type":"string","title":"Confirm Password"}},"type":"object","required":["reset_token","new_password","confirm_password"],"title":"PasswordResetConfirm","description":"Confirm password reset."},"PasswordResetRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"}},"type":"object","required":["email"],"title":"PasswordResetRequest","description":"Request password reset."},"RiskAssessmentResult":{"properties":{"risk_score":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Risk Score"},"risk_level":{"type":"string","title":"Risk Level"},"security_level":{"type":"integer","maximum":4.0,"minimum":0.0,"title":"Security Level"},"risk_factors":{"additionalProperties":{"type":"number"},"type":"object","title":"Risk Factors"},"required_action":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Required Action"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"}},"type":"object","required":["risk_score","risk_level","security_level","risk_factors"],"title":"RiskAssessmentResult","description":"Risk assessment result."},"RiskDashboardOverview":{"properties":{"total_risk_events":{"type":"integer","title":"Total Risk Events"},"high_risk_events":{"type":"integer","title":"High Risk Events"},"active_anomalies":{"type":"integer","title":"Active Anomalies"},"blocked_users":{"type":"integer","title":"Blocked Users"},"average_risk_score":{"type":"number","title":"Average Risk Score"},"risk_trend":{"type":"string","title":"Risk Trend"}},"type":"object","required":["total_risk_events","high_risk_events","active_anomalies","blocked_users","average_risk_score","risk_trend"],"title":"RiskDashboardOverview","description":"Risk dashboard overview."},"RiskEventList":{"properties":{"events":{"items":{"$ref":"#/components/schemas/RiskEventResponse"},"type":"array","title":"Events"},"total":{"type":"integer","title":"Total"},"page":{"type":"integer","title":"Page"},"page_size":{"type":"integer","title":"Page Size"}},"type":"object","required":["events","total","page","page_size"],"title":"RiskEventList","description":"List of risk events."},"RiskEventResponse":{"properties":{"id":{"type":"integer","title":"Id"},"event_type":{"type":"string","title":"Event Type"},"risk_score":{"type":"number","title":"Risk Score"},"risk_level":{"type":"string","title":"Risk Level"},"ip_address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ip Address"},"risk_factors":{"additionalProperties":true,"type":"object","title":"Risk Factors"},"action_taken":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Action Taken"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"resolved":{"type":"boolean","title":"Resolved"}},"type":"object","required":["id","event_type","risk_score","risk_level","ip_address","risk_factors","action_taken","created_at","resolved"],"title":"RiskEventResponse","description":"Risk event information."},"RiskStatistics":{"properties":{"period":{"type":"string","title":"Period"},"total_logins":{"type":"integer","title":"Total Logins"},"successful_logins":{"type":"integer","title":"Successful Logins"},"failed_logins":{"type":"integer","title":"Failed Logins"},"blocked_attempts":{"type":"integer","title":"Blocked Attempts"},"average_risk_score":{"type":"number","title":"Average Risk Score"},"risk_distribution":{"additionalProperties":{"type":"integer"},"type":"object","title":"Risk Distribution"}},"type":"object","required":["period","total_logins","successful_logins","failed_logins","blocked_attempts","average_risk_score","risk_distribution"],"title":"RiskStatistics","description":"Risk statistics."},"SessionInfo":{"properties":{"id":{"type":"integer","title":"Id"},"ip_address":{"type":"string","title":"Ip Address"},"user_agent":{"type":"string","title":"User Agent"},"country":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Country"},"city":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"City"},"risk_level":{"type":"string","title":"Risk Level"},"status":{"type":"string","title":"Status"},"last_activity":{"type":"string","format":"date-time","title":"Last Activity"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"is_current":{"type":"boolean","title":"Is Current","default":false}},"type":"object","required":["id","ip_address","user_agent","country","city","risk_level","status","last_activity","created_at"],"title":"SessionInfo","description":"Active session information."},"SessionListResponse":{"properties":{"sessions":{"items":{"$ref":"#/components/schemas/SessionInfo"},"type":"array","title":"Sessions"},"total":{"type":"integer","title":"Total"}},"type":"object","required":["sessions","total"],"title":"SessionListResponse","description":"List of user sessions."},"SessionRevokeRequest":{"properties":{"session_ids":{"items":{"type":"integer"},"type":"array","title":"Session Ids"},"revoke_all":{"type":"boolean","title":"Revoke All","default":false}},"type":"object","required":["session_ids"],"title":"SessionRevokeRequest","description":"Request to revoke session(s)."},"StepUpRequest":{"properties":{"challenge_id":{"type":"string","title":"Challenge Id"},"verification_code":{"type":"string","title":"Verification Code"}},"type":"object","required":["challenge_id","verification_code"],"title":"StepUpRequest","description":"Step-up authentication request."},"StepUpResponse":{"properties":{"status":{"type":"string","title":"Status"},"access_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"},"token_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Token Type","default":"bearer"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"}},"type":"object","required":["status"],"title":"StepUpResponse","description":"Step-up authentication response."},"TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In"},"user_info":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"User Info"}},"type":"object","required":["access_token","expires_in"],"title":"TokenResponse","description":"JWT token response."},"UserLogin":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","password"],"title":"UserLogin","description":"Standard login request."},"UserRegister":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","minLength":8,"title":"Password"},"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"}},"type":"object","required":["email","password"],"title":"UserRegister","description":"User registration request."},"UserResponse":{"properties":{"id":{"type":"integer","title":"Id"},"email":{"type":"string","title":"Email"},"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"},"role":{"type":"string","title":"Role"},"is_active":{"type":"boolean","title":"Is Active"},"is_verified":{"type":"boolean","title":"Is Verified"},"tfa_enabled":{"type":"boolean","title":"Tfa Enabled"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","email","full_name","role","is_active","is_verified","tfa_enabled","created_at"],"title":"UserResponse","description":"User information response."},"UserSecuritySettings":{"properties":{"tfa_enabled":{"type":"boolean","title":"Tfa Enabled"},"last_password_change":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Password Change"},"active_sessions":{"type":"integer","title":"Active Sessions"},"known_devices":{"type":"integer","title":"Known Devices"},"recent_login_attempts":{"type":"integer","title":"Recent Login Attempts"}},"type":"object","required":["tfa_enabled","last_password_change","active_sessions","known_devices","recent_login_attempts"],"title":"UserSecuritySettings","description":"User security settings response."},"UserUpdate":{"properties":{"full_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Full Name"},"email":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Email"}},"type":"object","title":"UserUpdate","description":"Update user information."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"},"input":{"title":"Input"},"ctx":{"type":"object","title":"Context"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"Verify2FARequest":{"properties":{"otp":{"type":"string","maxLength":6,"minLength":6,"title":"Otp"}},"type":"object","required":["otp"],"title":"Verify2FARequest","description":"Verify 2FA setup."},"VerifyChallengeRequest":{"properties":{"challenge_id":{"type":"string","title":"Challenge Id"},"code":{"type":"string","title":"Code"}},"type":"object","required":["challenge_id","code"],"title":"VerifyChallengeRequest","description":"Verify challenge code."}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"auth/login"}}}}}}